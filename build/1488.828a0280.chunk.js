"use strict";(self.webpackChunknews_auth=self.webpackChunknews_auth||[]).push([[1488],{31488:(T,p,a)=>{a.r(p),a.d(p,{default:()=>B});var e=a(46024),l=a(62552),c=a(62492),K=a(20596),P=a(28464),A=a(42816),D=a(5e3),b=a(35933),k=a(13384),y=a(35676),u=a(69372),w=a(63358),L=a(6464);const f=u.default.div`
  margin-top: 35px;

  & > div {
    margin-bottom: 15px;
  }
`,E=u.default.div`
  display: flex;
  margin-top: 15px;

  button {
    margin-right: 0.8rem;
  }
`,m=(0,u.default)(w.O)`
  margin-top: 15px;
`,x=(0,u.default)(L._)`
  margin-bottom: 30px;
`;var h=a(21808);const C={apiKey:"",apiSecret:"",dc:"",listID:"",formId:""},O=()=>{const[i,S]=l.useState(),[r,n]=l.useState(C),[g,j]=l.useState({}),[I,o]=l.useState(!1),[F,d]=l.useState(!1),M=["mailchimp","convertkit"],v={mailchimp:{name:"Mailchimp",validator:()=>!(!r.apiKey||!r.dc||!r.listID),checkConnection:async()=>{try{await(0,h.O4)(),d(!1),o("Connection Successful")}catch{d(!0),o(null)}},renderView:()=>(0,e.jsxs)(f,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"API Key",label:"API Key",required:!0,onChange:t=>n(s=>({...s,apiKey:t.target.value})),value:r.apiKey,type:"password"})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"DC",label:"DC",required:!0,onChange:t=>n(s=>({...s,dc:t.target.value})),value:r.dc})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"List ID",label:"List ID",required:!0,onChange:t=>n(s=>({...s,listID:t.target.value})),value:r.listID})}),(0,e.jsxs)(m,{as:"h3",children:["Read"," ",(0,e.jsx)("a",{href:"https://mailchimp.com/en-gb/help/find-audience-id/",target:"_blank",children:"here"})," ","to learn how to get the list ID from mailchimp."]})]})},convertkit:{name:"Convert Kit",validator:()=>!(!r.apiKey||!r.apiSecret||!r.formId),checkConnection:async()=>{try{await(0,h.kz)(),d(!1),o("Connection Successful")}catch{d(!0),o(null)}},renderView:()=>(0,e.jsxs)(f,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"API Key",label:"API Key",required:!0,onChange:t=>n(s=>({...s,apiKey:t.target.value})),value:r.apiKey})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"API Secret",label:"API Secret",required:!0,onChange:t=>n(s=>({...s,apiSecret:t.target.value})),value:r.apiSecret,type:"password"})}),(0,e.jsx)("div",{children:(0,e.jsx)(c.g,{placeholder:"Form ID",label:"Form ID",required:!0,onChange:t=>n(s=>({...s,formId:t.target.value})),value:r.formId})})]})}};l.useEffect(()=>{N()},[]);const N=async()=>{const{data:{provider:t,...s}}=await(0,h.Az)();j(s),n(s),S(t)},R=async()=>{const{data:t}=await(0,h.iU)({...r,provider:i});try{j(t),o("Settings saved successfully")}catch{d(!0),o(null)}};return(0,e.jsxs)(K._,{children:[(0,e.jsx)(P.s,{title:"Strapi Newsletter",subtitle:"Setup Your Newsletter Provider"}),(0,e.jsxs)(A.S,{children:[I&&(0,e.jsx)(x,{closeLabel:"Close alert",title:"Success",variant:"success",onClose:()=>{o(null)},children:I}),F&&(0,e.jsx)(x,{closeLabel:"Close alert",title:"Error",variant:"danger",onClose:()=>{d(!1)},children:"Error occurred, Please check your settings"}),(0,e.jsxs)(D.k,{padding:8,shadow:"tableShadow",background:"neutral0",hasRadius:!0,children:[(0,e.jsx)(b.M,{label:"Email Newsletter Provider",value:i,onChange:t=>{t!=i?n(C):n(g),S(t)},children:M.map(t=>(0,e.jsx)(k.c,{value:t,children:v[t].name},t))}),(0,e.jsx)("div",{children:i&&v[i].renderView()}),(0,e.jsx)(m,{as:"h3",children:"Configure A Newsletter Provider and Click On Check Connection Button After Saving Your Settings To Check If Your API Keys are Working."}),(0,e.jsxs)(E,{children:[(0,e.jsx)(y.Z,{onClick:async()=>{v[i].validator()&&await R()},children:"Save Keys"}),(0,e.jsx)(y.Z,{variant:"tertiary",disabled:Object.entries(g).length==0||r.apiKey!==g.apiKey,onClick:()=>{v[i].checkConnection()},children:"Check Connection"})]})]})]})]})},B=(0,l.memo)(O)}}]);
